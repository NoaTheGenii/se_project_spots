!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-btn",inactiveButtonClass:"modal__save-btn_disabled",inputErrorClass:"modal__input_invalid",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=e=>{e.disabled=!0},a=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.classList.add(r.inactiveButtonClass),o(t)):(t.classList.remove(r.inactiveButtonClass),(e=>{e.disabled=!1})(t))},n=e=>{document.querySelectorAll(e.formSelector).forEach(t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),n=e.querySelector(t.submitButtonSelector);a(o,n,t),o.forEach(s=>{s.addEventListener("input",function(){a(o,n,t),((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,s,t)})})})(t,e)})},s=(e,t,o)=>{t.forEach(t=>{r(e,t,o)})};n(t);function c(e,t,r="Saving...",o="Save"){e.textContent=t?r:o}var l=e+"8650253b58b46f0f1c06.svg",d=e+"ebe4a21ad964c3f377bb.png",i=e+"d423b294ea8188f53fb6.svg",u=e+"d0d66fed7ed9e2c3e979.svg",m=e+"a326e1ad56a2cd944a28.svg",f=e+"d73f076c46eb5467f5fc.svg";const h=document.querySelector("#header-logo"),_=document.querySelector("#bessie-colman-avatar"),v=document.querySelector("#profile-avatar-btn"),b=document.querySelector("#profile-edit-btn"),y=document.querySelector("#profile-add-btn"),p=document.querySelector("#edit-profile-close-btn"),S=document.querySelector("#add-post-close-btn"),q=document.querySelector("#avatar-close-btn");h.src=l,_.src=d,v.src=f,b.src=i,y.src=u,p.src=m,S.src=m,q.src=m;const E=document.querySelectorAll(".modal__close-btn"),k=document.querySelectorAll(".modal"),L=document.querySelector("#edit-profile-modal"),g=document.forms.editProfile,C=L.querySelector("#profile-name-input"),$=L.querySelector("#profile-job-input"),j=document.querySelector(".profile__edit-btn"),U=document.querySelector(".profile__name"),A=document.querySelector(".profile__text"),P=document.querySelector("#add-post-modal"),x=document.querySelector(".modal__save-btn"),D=document.forms.addPost,I=D.elements.link,T=D.elements.caption,w=document.querySelector("#card-template"),N=document.querySelector(".cards__list"),B=document.querySelector(".profile__add-img"),O=document.querySelector("#preview-modal"),J=O.querySelector(".modal__caption"),H=O.querySelector(".modal__img"),z=document.querySelector("#avatar-modal"),M=document.querySelector(".profile__avatar-btn"),F=document.forms.changeAvatar,G=F.elements.avatar,K=document.querySelector("#delete-modal"),Q=K.querySelector(".modal__delete-buttons"),R=K.querySelector(".modal__cancel-btn"),V=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}addNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a90bdb36-e55c-4a6c-9bf2-6ab2312d2f70","Content-Type":"application/json"}});function W(e){Z(e.target)}function X(e){"Escape"!==e.key&&27!==e.key||Z(document.querySelector(".modal_opened"))}function Y(e){e.classList.add("modal_opened"),document.addEventListener("keydown",X)}function Z(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",X)}let ee,te;function re(e){const t=w.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__paragraph"),o=t.querySelector(".card__image"),a=t.querySelector(".card__btn-heart"),n=t.querySelector(".card__button-delete");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked?a.classList.add("card__btn-heart_filled"):a.classList.remove("card__btn-heart_filled"),a.addEventListener("click",t=>{!function(e,t){const r=e.target;V.changeLikeStatus(t._id,t.isLiked).then(()=>{r.classList.toggle("card__btn-heart_filled"),t.isLiked=!t.isLiked}).catch(e=>{console.error(e)})}(t,e)}),n.addEventListener("click",r=>{r.preventDefault(),function(e,t){ee=e,te=t._id,Y(K)}(t,e)}),o.addEventListener("click",()=>{Y(O),H.src=e.link,H.alt=e.name,J.textContent=e.name}),t}V.getAppInfo().then(([e,t])=>{_.src=t.avatar,_.alt="Avatar of "+t.name,U.textContent=t.name,A.textContent=t.about,e.forEach(e=>{const t=re(e);return N.prepend(t)})}).catch(console.error),E.forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>Z(t))}),k.forEach(e=>{e.addEventListener("click",W)}),B.addEventListener("click",()=>{Y(P)}),D.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.addNewCard({name:T.value,link:I.value}).then(e=>{const t=re(e);N.prepend(t),D.reset(),o(x),Z(P)}).catch(console.error).finally(()=>{c(e.submitter,!1)})}),Q.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0,"Deleting...","Delete"),V.deleteCard(te).then(()=>{ee.remove(),Z(K)}).catch(console.error).finally(()=>{c(e.submitter,!1,"Deleting...","Delete")})}),R.addEventListener("click",()=>{Z(K)}),j.addEventListener("click",()=>{C.value=U.textContent,$.value=A.textContent,s(g,[C,$],t),Y(L)}),g.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.editUserInfo({name:C.value,about:$.value}).then(e=>{U.textContent=e.name,A.textContent=e.about}).catch(console.error).finally(()=>{c(e.submitter,!1)}),Z(L)}),M.addEventListener("click",()=>{Y(z),s(F,[G],t)}),F.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.editAvatarInfo(G.value).then(e=>{_.src=e.avatar,_.alt="Avatar of "+e.name}).catch(console.error).finally(()=>{c(e.submitter,!1)}),Z(z),F.reset()}),n(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQ0EsSUFBSUEsRUNEb0IsR0NBakIsTUFBTUMsRUFBVyxDQUNwQkMsYUFBYyxlQUNkQyxjQUFlLGdCQUNmQyxxQkFBc0IsbUJBQ3RCQyxvQkFBcUIsMkJBQ3JCQyxnQkFBaUIsdUJBQ2pCQyxXQUFZLGdCQVNWQyxFQUFpQkEsQ0FBQ0MsRUFBUUMsRUFBU0MsS0FDbEJGLEVBQU9HLGNBQWMsSUFBSUYsRUFBUUcsWUFDekNDLFlBQWMsR0FDekJKLEVBQVFLLFVBQVVDLE9BQU9MLEVBQU9MLGtCQWlCdkJXLEVBQWlCQyxJQUMxQkEsRUFBU0MsVUFBVyxHQU9sQkMsRUFBb0JBLENBQUNDLEVBQVdILEVBQVVQLEtBZHZCVSxJQUNkQSxFQUFVQyxLQUFNWixJQUNYQSxFQUFRYSxTQUFTQyxPQWF6QkMsQ0FBZ0JKLElBQ2hCSCxFQUFTSCxVQUFVVyxJQUFJZixFQUFPTixxQkFDOUJZLEVBQWNDLEtBRWRBLEVBQVNILFVBQVVDLE9BQU9MLEVBQU9OLHFCQVRuQmEsS0FDbEJBLEVBQVNDLFVBQVcsR0FTaEJRLENBQWFULEtBZ0JSVSxFQUFvQmpCLElBQ1prQixTQUFTQyxpQkFBaUJuQixFQUFPVCxjQUN6QzZCLFFBQVN0QixJQWRJdUIsRUFBQ3ZCLEVBQVFFLEtBQy9CLE1BQU1VLEVBQVlZLE1BQU1DLEtBQUt6QixFQUFPcUIsaUJBQWlCbkIsRUFBT1IsZ0JBQ3REZSxFQUFXVCxFQUFPRyxjQUFjRCxFQUFPUCxzQkFDN0NnQixFQUFrQkMsRUFBV0gsRUFBVVAsR0FDdkNVLEVBQVVVLFFBQVNyQixJQUNmQSxFQUFReUIsaUJBQWlCLFFBQVMsV0FDOUJmLEVBQWtCQyxFQUFXSCxFQUFVUCxHQXRDeEJ5QixFQUFDM0IsRUFBUUMsRUFBU0MsS0FDcENELEVBQVFhLFNBQVNDLE1BR2xCaEIsRUFBZUMsRUFBUUMsRUFBU0MsR0FoQmpCMEIsRUFBQzVCLEVBQVFDLEVBQVM0QixFQUFVM0IsS0FDNUJGLEVBQU9HLGNBQWMsSUFBSUYsRUFBUUcsWUFDekNDLFlBQWN3QixFQUN6QjVCLEVBQVFLLFVBQVVXLElBQUlmLEVBQU9MLGtCQVd6QitCLENBQWU1QixFQUFRQyxFQUFTQSxFQUFRNkIsa0JBQW1CNUIsSUFxQ3ZEeUIsQ0FBbUIzQixFQUFRQyxFQUFTQyxFQUN4QyxNQU9BcUIsQ0FBa0J2QixFQUFRRSxNQUlyQjZCLEVBQWtCQSxDQUFDL0IsRUFBUVksRUFBV1YsS0FDL0NVLEVBQVVVLFFBQVNVLElBQ2ZqQyxFQUFlQyxFQUFRZ0MsRUFBTzlCLE1BSXRDaUIsRUFBaUIzQixHQzlFRixTQUFTeUMsRUFDdEJDLEVBQ0FDLEVBQ0FDLEVBQWMsWUFDZEMsRUFBZSxRQUdiSCxFQUFPN0IsWUFETDhCLEVBQ21CQyxFQUVBQyxDQUV6QixDLDhMQ0tBLE1BQU1DLEVBQWNsQixTQUFTakIsY0FBYyxnQkFDckNvQyxFQUFTbkIsU0FBU2pCLGNBQWMseUJBQ2hDcUMsRUFBWXBCLFNBQVNqQixjQUFjLHVCQUNuQ3NDLEVBQVVyQixTQUFTakIsY0FBYyxxQkFDakN1QyxFQUFVdEIsU0FBU2pCLGNBQWMsb0JBQ2pDd0MsRUFBZXZCLFNBQVNqQixjQUFjLDJCQUN0Q3lDLEVBQWV4QixTQUFTakIsY0FBYyx1QkFDdEMwQyxFQUFjekIsU0FBU2pCLGNBQWMscUJBRTNDbUMsRUFBWVEsSUFBTUMsRUFDbEJSLEVBQU9PLElBQU1FLEVBQ2JSLEVBQVVNLElBQU1HLEVBQ2hCUixFQUFRSyxJQUFNSSxFQUNkUixFQUFRSSxJQUFNSyxFQUNkUixFQUFhRyxJQUFNTSxFQUNuQlIsRUFBYUUsSUFBTU0sRUFDbkJQLEVBQVlDLElBQU1NLEVBRWxCLE1BQU1DLEVBQWVqQyxTQUFTQyxpQkFBaUIscUJBQ3pDaUMsRUFBWWxDLFNBQVNDLGlCQUFpQixVQUV0Q2tDLEVBQWVuQyxTQUFTakIsY0FBYyx1QkFDdENxRCxFQUFxQnBDLFNBQVNxQyxNQUFNQyxZQUNwQ0MsRUFBbUJKLEVBQWFwRCxjQUFjLHVCQUM5Q3lELEVBQWtCTCxFQUFhcEQsY0FBYyxzQkFDN0MwRCxFQUFvQnpDLFNBQVNqQixjQUFjLHNCQUMzQzJELEVBQWMxQyxTQUFTakIsY0FBYyxrQkFDckM0RCxFQUFhM0MsU0FBU2pCLGNBQWMsa0JBRXBDNkQsRUFBWTVDLFNBQVNqQixjQUFjLG1CQUNuQzhELEVBQW1CN0MsU0FBU2pCLGNBQWMsb0JBQzFDK0QsRUFBa0I5QyxTQUFTcUMsTUFBTVUsUUFDakNDLEVBQWdCRixFQUFnQkcsU0FBU0MsS0FDekNDLEVBQW1CTCxFQUFnQkcsU0FBU0csUUFDNUNDLEVBQWVyRCxTQUFTakIsY0FBYyxrQkFDdEN1RSxFQUFZdEQsU0FBU2pCLGNBQWMsZ0JBQ25Dd0UsRUFBZ0J2RCxTQUFTakIsY0FBYyxxQkFFdkN5RSxFQUFleEQsU0FBU2pCLGNBQWMsa0JBQ3RDMEUsRUFBd0JELEVBQWF6RSxjQUFjLG1CQUNuRDJFLEVBQW9CRixFQUFhekUsY0FBYyxlQUUvQzRFLEVBQWMzRCxTQUFTakIsY0FBYyxpQkFDckM2RSxFQUFpQjVELFNBQVNqQixjQUFjLHdCQUN4QzhFLEVBQW9CN0QsU0FBU3FDLE1BQU15QixhQUNuQ0MsRUFBY0YsRUFBa0JaLFNBQVM5QixPQUV6QzZDLEVBQWNoRSxTQUFTakIsY0FBYyxpQkFDckNrRixFQUFvQkQsRUFBWWpGLGNBQWMsMEJBQzlDbUYsRUFBcUJGLEVBQVlqRixjQUFjLHNCQUUvQ29GLEVBQU0sSUNuRVosTUFDRUMsV0FBQUEsQ0FBWUMsR0FDVkMsS0FBS0MsU0FBV0YsRUFBUUcsUUFDeEJGLEtBQUtHLFNBQVdKLEVBQVFLLE9BQzFCLENBRUFDLFVBQUFBLEdBQ0UsT0FBT0MsUUFBUUMsSUFBSSxDQUFDUCxLQUFLUSxrQkFBbUJSLEtBQUtTLGVBQ25ELENBRUFELGVBQUFBLEdBQ0UsT0FBT0UsTUFBTSxHQUFHVixLQUFLQyxpQkFBa0IsQ0FDckNHLFFBQVNKLEtBQUtHLFdBQ2JRLEtBQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5SLFFBQVFTLE9BQU8sVUFBVUgsRUFBSUksVUFFeEMsQ0FFQVAsV0FBQUEsR0FDRSxPQUFPQyxNQUFNLEdBQUdWLEtBQUtDLG9CQUFxQixDQUN4Q0csUUFBU0osS0FBS0csV0FDYlEsS0FBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTlIsUUFBUVMsT0FBTyxVQUFVSCxFQUFJSSxVQUV4QyxDQUVBQyxZQUFBQSxFQUFhLEtBQUVDLEVBQUksTUFBRUMsSUFDbkIsT0FBT1QsTUFBTSxHQUFHVixLQUFLQyxvQkFBcUIsQ0FDeENtQixPQUFRLFFBQ1JoQixRQUFTSixLQUFLRyxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQkwsT0FDQUMsWUFFRFIsS0FBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTlIsUUFBUVMsT0FBTyxVQUFVSCxFQUFJSSxVQUV4QyxDQUVBUSxjQUFBQSxDQUFlM0UsR0FDYixPQUFPNkQsTUFBTSxHQUFHVixLQUFLQywyQkFBNEIsQ0FDL0NtQixPQUFRLFFBQ1JoQixRQUFTSixLQUFLRyxTQUNka0IsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQjFFLGFBRUQ4RCxLQUFNQyxHQUNIQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOUixRQUFRUyxPQUFPLFVBQVVILEVBQUlJLFVBRXhDLENBRUFTLFVBQUFBLEVBQVcsS0FBRVAsRUFBSSxLQUFFdEMsSUFDakIsT0FBTzhCLE1BQU0sR0FBR1YsS0FBS0MsaUJBQWtCLENBQ3JDbUIsT0FBUSxPQUNSaEIsUUFBU0osS0FBS0csU0FDZGtCLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJMLE9BQ0F0QyxXQUVEK0IsS0FBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTlIsUUFBUVMsT0FBTyxVQUFVSCxFQUFJSSxVQUV4QyxDQUVBVSxVQUFBQSxDQUFXQyxHQUNULE9BQU9qQixNQUFNLEdBQUdWLEtBQUtDLGtCQUFrQjBCLElBQVUsQ0FDL0NQLE9BQVEsU0FDUmhCLFFBQVNKLEtBQUtHLFdBQ2JRLEtBQU1DLEdBQ0hBLEVBQUlDLEdBQ0NELEVBQUlFLE9BRU5SLFFBQVFTLE9BQU8sVUFBVUgsRUFBSUksVUFFeEMsQ0FFQVksZ0JBQUFBLENBQWlCRCxFQUFRRSxHQUN2QixPQUFPbkIsTUFBTSxHQUFHVixLQUFLQyxrQkFBa0IwQixVQUFnQixDQUNyRFAsT0FBUVMsRUFBVSxTQUFXLE1BQzdCekIsUUFBU0osS0FBS0csV0FDYlEsS0FBTUMsR0FDSEEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FFTlIsUUFBUVMsT0FBTyxVQUFVSCxFQUFJSSxVQUV4QyxHRGxDa0IsQ0FDbEJkLFFBQVMsa0RBQ1RFLFFBQVMsQ0FDUDBCLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBbUJwQixTQUFTQyxFQUFVQyxHQUNqQkMsRUFBV0QsRUFBSUUsT0FDakIsQ0FFQSxTQUFTQyxFQUFrQkgsR0FDVCxXQUFaQSxFQUFJSSxLQUFnQyxLQUFaSixFQUFJSSxLQUU5QkgsRUFEb0J2RyxTQUFTakIsY0FBYyxpQkFHL0MsQ0FFQSxTQUFTNEgsRUFBVUMsR0FDakJBLEVBQU0xSCxVQUFVVyxJQUFJLGdCQUNwQkcsU0FBU00saUJBQWlCLFVBQVdtRyxFQUN2QyxDQUVBLFNBQVNGLEVBQVdLLEdBQ2xCQSxFQUFNMUgsVUFBVUMsT0FBTyxnQkFDdkJhLFNBQVM2RyxvQkFBb0IsVUFBV0osRUFDMUMsQ0FhQSxJQUFJSyxHQUFjQyxHQXVCbEIsU0FBU0MsR0FBZUMsR0FDdEIsTUFBTUMsRUFBYzdELEVBQWE4RCxRQUM5QnBJLGNBQWMsU0FDZHFJLFdBQVUsR0FDUEMsRUFBYUgsRUFBWW5JLGNBQWMsb0JBQ3ZDdUksRUFBWUosRUFBWW5JLGNBQWMsZ0JBQ3RDd0ksRUFBa0JMLEVBQVluSSxjQUFjLG9CQUM1Q3lJLEVBQWVOLEVBQVluSSxjQUFjLHdCQTBCL0MsT0F4QkFzSSxFQUFXcEksWUFBY2dJLEVBQUt6QixLQUM5QjhCLEVBQVU1RixJQUFNdUYsRUFBSy9ELEtBQ3JCb0UsRUFBVUcsSUFBTVIsRUFBS3pCLEtBRWpCeUIsRUFBS2QsUUFDUG9CLEVBQWdCckksVUFBVVcsSUFBSSwwQkFFOUIwSCxFQUFnQnJJLFVBQVVDLE9BQU8sMEJBR25Db0ksRUFBZ0JqSCxpQkFBaUIsUUFBVWdHLEtBc0M3QyxTQUFvQkEsRUFBS1csR0FDdkIsTUFBTVMsRUFBWXBCLEVBQUlFLE9BQ3RCckMsRUFDRytCLGlCQUFpQmUsRUFBS1UsSUFBS1YsRUFBS2QsU0FDaENsQixLQUFLLEtBQ0p5QyxFQUFVeEksVUFBVTBJLE9BQU8sMEJBQzNCWCxFQUFLZCxTQUFXYyxFQUFLZCxVQUV0QjBCLE1BQU9DLElBQ05DLFFBQVFDLE1BQU1GLElBRXBCLENBaERJRyxDQUFXM0IsRUFBS1csS0FFbEJPLEVBQWFsSCxpQkFBaUIsUUFBVWdHLElBQ3RDQSxFQUFJNEIsaUJBNUNSLFNBQTBCaEIsRUFBYUQsR0FDckNILEdBQWVJLEVBQ2ZILEdBQWlCRSxFQUFLVSxJQUN0QmhCLEVBQVUzQyxFQUNaLENBeUNJbUUsQ0FBaUJqQixFQUFhRCxLQUVoQ0ssRUFBVWhILGlCQUFpQixRQUFTLEtBQ2xDcUcsRUFBVW5ELEdBQ1ZFLEVBQWtCaEMsSUFBTXVGLEVBQUsvRCxLQUM3QlEsRUFBa0IrRCxJQUFNUixFQUFLekIsS0FDN0IvQixFQUFzQnhFLFlBQWNnSSxFQUFLekIsT0FHcEMwQixDQUNULENBeEdBL0MsRUFDR1EsYUFDQU0sS0FBSyxFQUFFbUQsRUFBT0MsTUFDYmxILEVBQU9PLElBQU0yRyxFQUFTbEgsT0FDdEJBLEVBQU9zRyxJQUFNLGFBQWVZLEVBQVM3QyxLQUNyQzlDLEVBQVl6RCxZQUFjb0osRUFBUzdDLEtBQ25DN0MsRUFBVzFELFlBQWNvSixFQUFTNUMsTUFFbEMyQyxFQUFNbEksUUFBU29JLElBQ2IsTUFBTXBCLEVBQWNGLEdBQWVzQixHQUNuQyxPQUFPaEYsRUFBVWlGLFFBQVFyQixPQUc1QlcsTUFBTUUsUUFBUUMsT0F1QmpCL0YsRUFBYS9CLFFBQVNZLElBQ3BCLE1BQU0wSCxFQUFRMUgsRUFBTzJILFFBQVEsVUFDN0IzSCxFQUFPUixpQkFBaUIsUUFBUyxJQUFNaUcsRUFBV2lDLE1BR3BEdEcsRUFBVWhDLFFBQVMwRyxJQUNqQkEsRUFBTXRHLGlCQUFpQixRQUFTK0YsS0FrR2xDOUMsRUFBY2pELGlCQUFpQixRQUFTLEtBQ3RDcUcsRUFBVS9ELEtBR1pFLEVBQWdCeEMsaUJBQWlCLFNBdENqQyxTQUE2QmdHLEdBQzNCQSxFQUFJNEIsaUJBQ0pySCxFQUFjeUYsRUFBSW9DLFdBQVcsR0FDN0J2RSxFQUNHNEIsV0FBVyxDQUNWUCxLQUFNckMsRUFBaUJ3RixNQUN2QnpGLEtBQU1GLEVBQWMyRixRQUVyQjFELEtBQU1nQyxJQUNMLE1BQU0yQixFQUFVNUIsR0FBZUMsR0FDL0IzRCxFQUFVaUYsUUFBUUssR0FDbEI5RixFQUFnQitGLFFBQ2hCekosRUFBY3lELEdBQ2QwRCxFQUFXM0QsS0FFWmlGLE1BQU1FLFFBQVFDLE9BQ2RjLFFBQVEsS0FDUGpJLEVBQWN5RixFQUFJb0MsV0FBVyxJQUVuQyxHQW9CQXpFLEVBQWtCM0QsaUJBQWlCLFNBMUZuQyxTQUE0QmdHLEdBQzFCQSxFQUFJNEIsaUJBQ0pySCxFQUFjeUYsRUFBSW9DLFdBQVcsRUFBTSxjQUFlLFVBQ2xEdkUsRUFDRzZCLFdBQVdlLElBQ1g5QixLQUFLLEtBQ0o2QixHQUFhM0gsU0FDYm9ILEVBQVd2QyxLQUVaNkQsTUFBTUUsUUFBUUMsT0FDZGMsUUFBUSxLQUNQakksRUFBY3lGLEVBQUlvQyxXQUFXLEVBQU8sY0FBZSxXQUV6RCxHQThFQXhFLEVBQW1CNUQsaUJBQWlCLFFBQVMsS0FDM0NpRyxFQUFXdkMsS0F3QmJ2QixFQUFrQm5DLGlCQUFpQixRQUFTLEtBQzFDaUMsRUFBaUJvRyxNQUFRakcsRUFBWXpELFlBQ3JDdUQsRUFBZ0JtRyxNQUFRaEcsRUFBVzFELFlBQ25DMEIsRUFDRXlCLEVBQ0EsQ0FBQ0csRUFBa0JDLEdBQ25CcEUsR0FFRnVJLEVBQVV4RSxLQUdaQyxFQUFtQjlCLGlCQUFpQixTQTlCcEMsU0FBaUNnRyxHQUMvQkEsRUFBSTRCLGlCQUNKckgsRUFBY3lGLEVBQUlvQyxXQUFXLEdBQzdCdkUsRUFDR29CLGFBQWEsQ0FDWkMsS0FBTWpELEVBQWlCb0csTUFDdkJsRCxNQUFPakQsRUFBZ0JtRyxRQUV4QjFELEtBQU1nQyxJQUNMdkUsRUFBWXpELFlBQWNnSSxFQUFLekIsS0FDL0I3QyxFQUFXMUQsWUFBY2dJLEVBQUt4QixRQUUvQm9DLE1BQU1FLFFBQVFDLE9BQ2RjLFFBQVEsS0FDUGpJLEVBQWN5RixFQUFJb0MsV0FBVyxLQUVqQ25DLEVBQVdwRSxFQUNiLEdBa0NBeUIsRUFBZXRELGlCQUFpQixRQUFTLEtBQ3ZDcUcsRUFBVWhELEdBQ1ZoRCxFQUFnQmtELEVBQW1CLENBQUNFLEdBQWMzRixLQUdwRHlGLEVBQWtCdkQsaUJBQWlCLFNBdEJuQyxTQUFnQ2dHLEdBQzlCQSxFQUFJNEIsaUJBQ0pySCxFQUFjeUYsRUFBSW9DLFdBQVcsR0FDN0J2RSxFQUNHMkIsZUFBZS9CLEVBQVk0RSxPQUMzQjFELEtBQU1nQyxJQUNMOUYsRUFBT08sSUFBTXVGLEVBQUs5RixPQUNsQkEsRUFBT3NHLElBQU0sYUFBZVIsRUFBS3pCLE9BRWxDcUMsTUFBTUUsUUFBUUMsT0FDZGMsUUFBUSxLQUNQakksRUFBY3lGLEVBQUlvQyxXQUFXLEtBRWpDbkMsRUFBVzVDLEdBQ1hFLEVBQWtCZ0YsT0FDcEIsR0FTQTlJLEVBQWlCM0IsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idG5cIixcclxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3NhdmUtYnRuX2Rpc2FibGVkXCIsXHJcbiAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X2ludmFsaWRcIixcclxuICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XHJcbiAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWwpID0+IHtcclxuICAgICAgICByZXR1cm4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsKSA9PiB7XHJcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWwpID0+IHtcclxuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICAgIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgICAgIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICBlbmFibGVCdXR0b24oYnV0dG9uRWwpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIGNvbnN0IGJ1dHRvbkVsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKTtcclxuICAgICAgICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3Rvcik7XHJcbiAgICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWwpID0+IHtcclxuICAgICAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsLCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoXHJcbiAgYnV0dG9uLFxyXG4gIGlzTG9hZGluZyxcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIsXHJcbiAgb3JpZ2luYWxUZXh0ID0gXCJTYXZlXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHtcclxuICBzZXR0aW5ncyxcclxuICBkaXNhYmxlQnV0dG9uLFxyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCBzZXRCdXR0b25UZXh0IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcbmltcG9ydCBsb2dvSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgcHJvZmlsZUF2YXRhciBmcm9tIFwiLi4vaW1hZ2VzL2Jlc3NpZS1jb2xtYW4ucG5nXCI7XHJcbmltcG9ydCBwcm9maWxlRWRpdEJ0biBmcm9tIFwiLi4vaW1hZ2VzL2VkaXQtYnV0dG9uLXBlbmNpbC5zdmdcIjtcclxuaW1wb3J0IGFkZFBvc3RCdG4gZnJvbSBcIi4uL2ltYWdlcy9wb3N0LWJ1dHRvbi5zdmdcIjtcclxuaW1wb3J0IGNsb3NlQnRuIGZyb20gXCIuLi9pbWFnZXMvY2xvc2UtYnV0dG9uLnN2Z1wiO1xyXG5pbXBvcnQgd2hpdGVQZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtd2hpdGUuc3ZnXCI7XHJcblxyXG5jb25zdCBwcm9maWxlTG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaGVhZGVyLWxvZ29cIik7XHJcbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmVzc2llLWNvbG1hbi1hdmF0YXJcIik7XHJcbmNvbnN0IGF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBlZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnRuXCIpO1xyXG5jb25zdCBwb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idG5cIik7XHJcbmNvbnN0IHByb2ZpbGVDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWNsb3NlLWJ0blwiKTtcclxuY29uc3QgYWRkUG9zdENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtcG9zdC1jbG9zZS1idG5cIik7XHJcbmNvbnN0IGF2YXRhckNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItY2xvc2UtYnRuXCIpO1xyXG5cclxucHJvZmlsZUxvZ28uc3JjID0gbG9nb0ltYWdlO1xyXG5hdmF0YXIuc3JjID0gcHJvZmlsZUF2YXRhcjtcclxuYXZhdGFyQnRuLnNyYyA9IHdoaXRlUGVuY2lsO1xyXG5lZGl0QnRuLnNyYyA9IHByb2ZpbGVFZGl0QnRuO1xyXG5wb3N0QnRuLnNyYyA9IGFkZFBvc3RCdG47XHJcbnByb2ZpbGVDbG9zZS5zcmMgPSBjbG9zZUJ0bjtcclxuYWRkUG9zdENsb3NlLnNyYyA9IGNsb3NlQnRuO1xyXG5hdmF0YXJDbG9zZS5zcmMgPSBjbG9zZUJ0bjtcclxuXHJcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgYWxsTW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5lZGl0UHJvZmlsZTtcclxuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IHByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZUpvYklucHV0ID0gcHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1qb2ItaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RleHRcIik7XHJcblxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3N0LW1vZGFsXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idG5cIik7XHJcbmNvbnN0IGNhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLmFkZFBvc3Q7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkRm9ybUVsZW1lbnQuZWxlbWVudHMubGluaztcclxuY29uc3QgY2FyZENhcHRpb25JbnB1dCA9IGNhcmRGb3JtRWxlbWVudC5lbGVtZW50cy5jYXB0aW9uO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1pbWdcIik7XHJcblxyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWdFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWdcIik7XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5jaGFuZ2VBdmF0YXI7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyRm9ybUVsZW1lbnQuZWxlbWVudHMuYXZhdGFyO1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybUVsZW1lbnQgPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUtYnV0dG9uc1wiKTtcclxuY29uc3QgZGVsZXRlQ2FuY2VsQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImE5MGJkYjM2LWU1NWMtNGE2Yy05YmYyLTZhYjIzMTJkMmY3MFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgICBhdmF0YXIuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gICAgYXZhdGFyLmFsdCA9IFwiQXZhdGFyIG9mIFwiICsgdXNlckluZm8ubmFtZTtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcclxuICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuXHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIHJldHVybiBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxuXHJcbmZ1bmN0aW9uIGV4aXRNb2RhbChldnQpIHtcclxuICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVNb2RhbEVzY2FwZShldnQpIHtcclxuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIiB8fCBldnQua2V5ID09PSAyNykge1xyXG4gICAgY29uc3Qgb3BlbmVkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGNsb3NlTW9kYWwob3BlbmVkTW9kYWwpO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVNb2RhbEVzY2FwZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZU1vZGFsRXNjYXBlKTtcclxufVxyXG5cclxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xyXG4gIGNvbnN0IHBvcHVwID0gYnV0dG9uLmNsb3Nlc3QoXCIubW9kYWxcIik7XHJcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHBvcHVwKSk7XHJcbn0pO1xyXG5cclxuYWxsTW9kYWxzLmZvckVhY2goKG1vZGFsKSA9PiB7XHJcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV4aXRNb2RhbCk7XHJcbn0pO1xyXG5cclxuLy8gQ2FyZCBmdW5jdGlvbnNcclxuXHJcbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xyXG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNldEJ1dHRvblRleHQoZXZ0LnN1Ym1pdHRlciwgdHJ1ZSwgXCJEZWxldGluZy4uLlwiLCBcIkRlbGV0ZVwiKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIGZhbHNlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BhcmFncmFwaFwiKTtcclxuICBjb25zdCBjYXJkSW1nRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGhlYXJ0TGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnRuLWhlYXJ0XCIpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWRlbGV0ZVwiKTtcclxuXHJcbiAgY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1nRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWdFbC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGhlYXJ0TGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fYnRuLWhlYXJ0X2ZpbGxlZFwiKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGVhcnRMaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idG4taGVhcnRfZmlsbGVkXCIpO1xyXG4gIH1cclxuXHJcbiAgaGVhcnRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICB0b2dnbGVMaWtlKGV2dCwgZGF0YSk7XHJcbiAgfSk7XHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gIH0pO1xyXG4gIGNhcmRJbWdFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWdFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWdFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoe1xyXG4gICAgICBuYW1lOiBjYXJkQ2FwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgICBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQobmV3Q2FyZCk7XHJcbiAgICAgIGNhcmRGb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24pO1xyXG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoZXZ0LnN1Ym1pdHRlciwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUxpa2UoZXZ0LCBkYXRhKSB7XHJcbiAgY29uc3QgaGVhcnRJY29uID0gZXZ0LnRhcmdldDtcclxuICBhcGlcclxuICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGRhdGEuX2lkLCBkYXRhLmlzTGlrZWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGhlYXJ0SWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnRuLWhlYXJ0X2ZpbGxlZFwiKTtcclxuICAgICAgZGF0YS5pc0xpa2VkID0gIWRhdGEuaXNMaWtlZDtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhcmRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5kZWxldGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcbmRlbGV0ZUNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIFByb2ZpbGUgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHByb2ZpbGVOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGFib3V0OiBwcm9maWxlSm9iSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIGZhbHNlKTtcclxuICAgIH0pO1xyXG4gIGNsb3NlTW9kYWwocHJvZmlsZU1vZGFsKTtcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgcHJvZmlsZUpvYklucHV0LnZhbHVlID0gcHJvZmlsZUpvYi50ZXh0Q29udGVudDtcclxuICByZXNldFZhbGlkYXRpb24oXHJcbiAgICBwcm9maWxlRm9ybUVsZW1lbnQsXHJcbiAgICBbcHJvZmlsZU5hbWVJbnB1dCwgcHJvZmlsZUpvYklucHV0XSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuICBvcGVuTW9kYWwocHJvZmlsZU1vZGFsKTtcclxufSk7XHJcblxyXG5wcm9maWxlRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdCk7XHJcblxyXG4vLyBBdmF0YXIgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHNldEJ1dHRvblRleHQoZXZ0LnN1Ym1pdHRlciwgdHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhckluZm8oYXZhdGFySW5wdXQudmFsdWUpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBhdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgIGF2YXRhci5hbHQgPSBcIkF2YXRhciBvZiBcIiArIGRhdGEubmFtZTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChldnQuc3VibWl0dGVyLCBmYWxzZSk7XHJcbiAgICB9KTtcclxuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICBhdmF0YXJGb3JtRWxlbWVudC5yZXNldCgpO1xyXG59XHJcblxyXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKGF2YXRhckZvcm1FbGVtZW50LCBbYXZhdGFySW5wdXRdLCBzZXR0aW5ncyk7XHJcbn0pO1xyXG5cclxuYXZhdGFyRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlU3RhdHVzKGNhcmRJZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbCIsImlucHV0RWwiLCJjb25maWciLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImRpc2FibGVCdXR0b24iLCJidXR0b25FbCIsImRpc2FibGVkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImFkZCIsImVuYWJsZUJ1dHRvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJhZGRFdmVudExpc3RlbmVyIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZyIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVzZXRWYWxpZGF0aW9uIiwiaW5wdXQiLCJzZXRCdXR0b25UZXh0IiwiYnV0dG9uIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJvcmlnaW5hbFRleHQiLCJwcm9maWxlTG9nbyIsImF2YXRhciIsImF2YXRhckJ0biIsImVkaXRCdG4iLCJwb3N0QnRuIiwicHJvZmlsZUNsb3NlIiwiYWRkUG9zdENsb3NlIiwiYXZhdGFyQ2xvc2UiLCJzcmMiLCJsb2dvSW1hZ2UiLCJwcm9maWxlQXZhdGFyIiwid2hpdGVQZW5jaWwiLCJwcm9maWxlRWRpdEJ0biIsImFkZFBvc3RCdG4iLCJjbG9zZUJ0biIsImNsb3NlQnV0dG9ucyIsImFsbE1vZGFscyIsInByb2ZpbGVNb2RhbCIsInByb2ZpbGVGb3JtRWxlbWVudCIsImZvcm1zIiwiZWRpdFByb2ZpbGUiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZUpvYklucHV0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlTmFtZSIsInByb2ZpbGVKb2IiLCJjYXJkTW9kYWwiLCJjYXJkU3VibWl0QnV0dG9uIiwiY2FyZEZvcm1FbGVtZW50IiwiYWRkUG9zdCIsImNhcmRMaW5rSW5wdXQiLCJlbGVtZW50cyIsImxpbmsiLCJjYXJkQ2FwdGlvbklucHV0IiwiY2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImNhcmRzTGlzdCIsImFkZENhcmRCdXR0b24iLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJwcmV2aWV3TW9kYWxJbWdFbCIsImF2YXRhck1vZGFsIiwiYXZhdGFyTW9kYWxCdG4iLCJhdmF0YXJGb3JtRWxlbWVudCIsImNoYW5nZUF2YXRhciIsImF2YXRhcklucHV0IiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtRWxlbWVudCIsImRlbGV0ZUNhbmNlbEJ1dHRvbiIsImFwaSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInRoaXMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFySW5mbyIsImFkZE5ld0NhcmQiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiY2hhbmdlTGlrZVN0YXR1cyIsImlzTGlrZWQiLCJhdXRob3JpemF0aW9uIiwiZXhpdE1vZGFsIiwiZXZ0IiwiY2xvc2VNb2RhbCIsInRhcmdldCIsImhhbmRsZU1vZGFsRXNjYXBlIiwia2V5Iiwib3Blbk1vZGFsIiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltZ0VsIiwiaGVhcnRMaWtlQnV0dG9uIiwiZGVsZXRlQnV0dG9uIiwiYWx0IiwiaGVhcnRJY29uIiwiX2lkIiwidG9nZ2xlIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJ0b2dnbGVMaWtlIiwicHJldmVudERlZmF1bHQiLCJoYW5kbGVEZWxldGVDYXJkIiwiY2FyZHMiLCJ1c2VySW5mbyIsImNhcmQiLCJwcmVwZW5kIiwicG9wdXAiLCJjbG9zZXN0Iiwic3VibWl0dGVyIiwidmFsdWUiLCJuZXdDYXJkIiwicmVzZXQiLCJmaW5hbGx5Il0sInNvdXJjZVJvb3QiOiIifQ==