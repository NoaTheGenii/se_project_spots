!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-btn",inactiveButtonClass:"modal__save-btn_disabled",inputErrorClass:"modal__input_invalid",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},n=e=>{e.disabled=!0},a=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.classList.add(r.inactiveButtonClass),n(t)):(t.classList.remove(r.inactiveButtonClass),(e=>{e.disabled=!1})(t))},o=e=>{document.querySelectorAll(e.formSelector).forEach(t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);a(n,o,t),n.forEach(s=>{s.addEventListener("input",function(){a(n,o,t),((e,t,n)=>{t.validity.valid?r(e,t,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,n)})(e,s,t)})})})(t,e)})},s=(e,t,n)=>{t.forEach(t=>{r(e,t,n)})};o(t);function c(e,t,r="Saving...",n="Save"){e.textContent=t?r:n}var d=e+"8650253b58b46f0f1c06.svg",i=e+"ebe4a21ad964c3f377bb.png",l=e+"d423b294ea8188f53fb6.svg",u=e+"d0d66fed7ed9e2c3e979.svg",m=e+"a326e1ad56a2cd944a28.svg",h=e+"d73f076c46eb5467f5fc.svg";const _=document.querySelector("#header-logo"),f=document.querySelector("#bessie-colman-avatar"),v=document.querySelector("#profile-avatar-btn"),b=document.querySelector("#profile-edit-btn"),p=document.querySelector("#profile-add-btn"),y=document.querySelector("#edit-profile-close-btn"),S=document.querySelector("#add-post-close-btn"),q=document.querySelector("#avatar-close-btn");_.src=d,f.src=i,v.src=h,b.src=l,p.src=u,y.src=m,S.src=m,q.src=m;const g=document.querySelectorAll(".modal__close-btn"),k=document.querySelectorAll(".modal"),E=document.querySelector("#edit-profile-modal"),L=document.forms.editProfile,C=E.querySelector("#profile-name-input"),U=E.querySelector("#profile-job-input"),A=document.querySelector(".profile__edit-btn"),x=document.querySelector(".profile__name"),$=document.querySelector(".profile__text"),D=document.querySelector("#add-post-modal"),I=document.querySelector(".modal__save-btn"),R=document.forms.addPost,P=R.elements.link,w=R.elements.caption,T=document.querySelector("#card-template"),N=document.querySelector(".cards__list"),B=document.querySelector(".profile__add-img"),j=document.querySelector("#preview-modal"),O=j.querySelector(".modal__caption"),J=j.querySelector(".modal__img"),H=document.querySelector("#avatar-modal"),z=document.querySelector(".profile__avatar-btn"),M=document.forms.changeAvatar,F=M.elements.avatar,G=document.querySelector("#delete-modal"),K=G.querySelector(".modal__delete-buttons"),Q=G.querySelector(".modal__cancel-btn"),V=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers,this._checkResponse=this._checkResponse.bind(this)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}addNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a90bdb36-e55c-4a6c-9bf2-6ab2312d2f70","Content-Type":"application/json"}});function W(e){Z(e.target)}function X(e){"Escape"!==e.key&&27!==e.key||Z(document.querySelector(".modal_opened"))}function Y(e){e.classList.add("modal_opened"),document.addEventListener("keydown",X)}function Z(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",X)}let ee,te;function re(e){const t=T.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__paragraph"),n=t.querySelector(".card__image"),a=t.querySelector(".card__btn-heart"),o=t.querySelector(".card__button-delete");return r.textContent=e.name,n.src=e.link,n.alt=e.name,e.isLiked?a.classList.add("card__btn-heart_filled"):a.classList.remove("card__btn-heart_filled"),a.addEventListener("click",t=>{!function(e,t){const r=e.target;V.changeLikeStatus(t._id,t.isLiked).then(()=>{r.classList.toggle("card__btn-heart_filled"),t.isLiked=!t.isLiked}).catch(e=>{console.error("Like status not changed:",e)})}(t,e)}),o.addEventListener("click",r=>{r.preventDefault(),function(e,t){ee=e,te=t._id,Y(G)}(t,e)}),n.addEventListener("click",()=>{Y(j),J.src=e.link,J.alt=e.name,O.textContent=e.name}),t}V.getAppInfo().then(([e,t])=>{f.src=t.avatar,f.alt="Avatar of "+t.name,x.textContent=t.name,$.textContent=t.about,e.forEach(e=>{const t=re(e);return N.prepend(t)})}).catch(e=>{console.error("Error fetching initial data:",e)}),g.forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>Z(t))}),k.forEach(e=>{e.addEventListener("click",W)}),B.addEventListener("click",()=>{Y(D)}),R.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.addNewCard({name:w.value,link:P.value}).then(t=>{const r=re(t);N.prepend(r),R.reset(),n(e.submitter),Z(D)}).catch(e=>{console.error("Error adding new card:",e)}).finally(()=>{c(e.submitter,!1)})}),K.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0,"Deleting...","Delete"),V.deleteCard(te).then(()=>{ee.remove(),Z(G),n(I)}).catch(e=>{console.error("Error deleting card:",e)}).finally(()=>{c(e.submitter,!1,"Deleting...","Delete")})}),Q.addEventListener("click",()=>{Z(G)}),A.addEventListener("click",()=>{C.value=x.textContent,U.value=$.textContent,s(L,[C,U],t),Y(E)}),L.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.editUserInfo({name:C.value,about:U.value}).then(t=>{x.textContent=t.name,$.textContent=t.about,n(e.submitter),Z(E)}).catch(e=>{console.error("Error updating user info:",e)}).finally(()=>{c(e.submitter,!1)})}),z.addEventListener("click",()=>{Y(H),s(M,[F],t)}),M.addEventListener("submit",function(e){e.preventDefault(),c(e.submitter,!0),V.editAvatarInfo(F.value).then(t=>{f.src=t.avatar,f.alt="Avatar of "+t.name,console.log(e.submitter),n(e.submitter),Z(H),M.reset()}).catch(e=>{console.error("Error updating avatar:",e)}).finally(()=>{c(e.submitter,!1)})}),o(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBNkJGLEtBRTVDZ0IsUUFBUSxLQUNQbkksRUFBYzJGLEVBQUlvQyxXQUFXLElBRW5DLEdBc0NBaEYsRUFBZXRELGlCQUFpQixRQUFTLEtBQ3ZDdUcsRUFBVWxELEdBQ1ZoRCxFQUFnQmtELEVBQW1CLENBQUNFLEdBQWMzRixLQUdwRHlGLEVBQWtCdkQsaUJBQWlCLFNBMUJuQyxTQUFnQ2tHLEdBQzlCQSxFQUFJNEIsaUJBQ0p2SCxFQUFjMkYsRUFBSW9DLFdBQVcsR0FDN0J6RSxFQUNHNkIsZUFBZWpDLEVBQVk4RSxPQUMzQnJELEtBQU0yQixJQUNMaEcsRUFBT08sSUFBTXlGLEVBQUtoRyxPQUNsQkEsRUFBT3dHLElBQU0sYUFBZVIsRUFBS3pCLEtBQ2pDdUMsUUFBUWdCLElBQUl6QyxFQUFJb0MsV0FDaEJ4SixFQUFjb0gsRUFBSW9DLFdBQ2xCbkMsRUFBVzlDLEdBQ1hFLEVBQWtCa0YsVUFFbkJoQixNQUFPQyxJQUNOQyxRQUFRQyxNQUFNLHlCQUEwQkYsS0FFekNnQixRQUFRLEtBQ1BuSSxFQUFjMkYsRUFBSW9DLFdBQVcsSUFFbkMsR0FTQTdJLEVBQWlCM0IsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjsiLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idG5cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ0bl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfaW52YWxpZFwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG5jb25zdCBzaG93SW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGVycm9yTXNnLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IGVycm9yTXNnO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlLCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbCkgPT4ge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwpID0+IHtcclxuICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XHJcbn07XHJcblxyXG5jb25zdCBlbmFibGVCdXR0b24gPSAoYnV0dG9uRWwpID0+IHtcclxuICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIGVuYWJsZUJ1dHRvbihidXR0b25FbCk7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWwgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKTtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoXHJcbiAgYnV0dG9uLFxyXG4gIGlzTG9hZGluZyxcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIsXHJcbiAgb3JpZ2luYWxUZXh0ID0gXCJTYXZlXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IG9yaWdpbmFsVGV4dDtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHtcclxuICBzZXR0aW5ncyxcclxuICBkaXNhYmxlQnV0dG9uLFxyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XHJcbmltcG9ydCBzZXRCdXR0b25UZXh0IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcbmltcG9ydCBsb2dvSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgcHJvZmlsZUF2YXRhciBmcm9tIFwiLi4vaW1hZ2VzL2Jlc3NpZS1jb2xtYW4ucG5nXCI7XHJcbmltcG9ydCBwcm9maWxlRWRpdEJ0biBmcm9tIFwiLi4vaW1hZ2VzL2VkaXQtYnV0dG9uLXBlbmNpbC5zdmdcIjtcclxuaW1wb3J0IGFkZFBvc3RCdG4gZnJvbSBcIi4uL2ltYWdlcy9wb3N0LWJ1dHRvbi5zdmdcIjtcclxuaW1wb3J0IGNsb3NlQnRuIGZyb20gXCIuLi9pbWFnZXMvY2xvc2UtYnV0dG9uLnN2Z1wiO1xyXG5pbXBvcnQgd2hpdGVQZW5jaWwgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtd2hpdGUuc3ZnXCI7XHJcblxyXG5jb25zdCBwcm9maWxlTG9nbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaGVhZGVyLWxvZ29cIik7XHJcbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYmVzc2llLWNvbG1hbi1hdmF0YXJcIik7XHJcbmNvbnN0IGF2YXRhckJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItYnRuXCIpO1xyXG5jb25zdCBlZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnRuXCIpO1xyXG5jb25zdCBwb3N0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idG5cIik7XHJcbmNvbnN0IHByb2ZpbGVDbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWNsb3NlLWJ0blwiKTtcclxuY29uc3QgYWRkUG9zdENsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtcG9zdC1jbG9zZS1idG5cIik7XHJcbmNvbnN0IGF2YXRhckNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItY2xvc2UtYnRuXCIpO1xyXG5cclxucHJvZmlsZUxvZ28uc3JjID0gbG9nb0ltYWdlO1xyXG5hdmF0YXIuc3JjID0gcHJvZmlsZUF2YXRhcjtcclxuYXZhdGFyQnRuLnNyYyA9IHdoaXRlUGVuY2lsO1xyXG5lZGl0QnRuLnNyYyA9IHByb2ZpbGVFZGl0QnRuO1xyXG5wb3N0QnRuLnNyYyA9IGFkZFBvc3RCdG47XHJcbnByb2ZpbGVDbG9zZS5zcmMgPSBjbG9zZUJ0bjtcclxuYWRkUG9zdENsb3NlLnNyYyA9IGNsb3NlQnRuO1xyXG5hdmF0YXJDbG9zZS5zcmMgPSBjbG9zZUJ0bjtcclxuXHJcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgYWxsTW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5lZGl0UHJvZmlsZTtcclxuY29uc3QgcHJvZmlsZU5hbWVJbnB1dCA9IHByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgcHJvZmlsZUpvYklucHV0ID0gcHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1qb2ItaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RleHRcIik7XHJcblxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3N0LW1vZGFsXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idG5cIik7XHJcbmNvbnN0IGNhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLmFkZFBvc3Q7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkRm9ybUVsZW1lbnQuZWxlbWVudHMubGluaztcclxuY29uc3QgY2FyZENhcHRpb25JbnB1dCA9IGNhcmRGb3JtRWxlbWVudC5lbGVtZW50cy5jYXB0aW9uO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1pbWdcIik7XHJcblxyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWdFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWdcIik7XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5jaGFuZ2VBdmF0YXI7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyRm9ybUVsZW1lbnQuZWxlbWVudHMuYXZhdGFyO1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybUVsZW1lbnQgPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUtYnV0dG9uc1wiKTtcclxuY29uc3QgZGVsZXRlQ2FuY2VsQnV0dG9uID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FuY2VsLWJ0blwiKTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImE5MGJkYjM2LWU1NWMtNGE2Yy05YmYyLTZhYjIzMTJkMmY3MFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgICBhdmF0YXIuc3JjID0gdXNlckluZm8uYXZhdGFyO1xyXG4gICAgYXZhdGFyLmFsdCA9IFwiQXZhdGFyIG9mIFwiICsgdXNlckluZm8ubmFtZTtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcclxuICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSB1c2VySW5mby5hYm91dDtcclxuXHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIHJldHVybiBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgaW5pdGlhbCBkYXRhOlwiLCBlcnIpO1xyXG4gIH0pO1xyXG5cclxuZnVuY3Rpb24gZXhpdE1vZGFsKGV2dCkge1xyXG4gIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZU1vZGFsRXNjYXBlKGV2dCkge1xyXG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiIHx8IGV2dC5rZXkgPT09IDI3KSB7XHJcbiAgICBjb25zdCBvcGVuZWRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgY2xvc2VNb2RhbChvcGVuZWRNb2RhbCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZU1vZGFsRXNjYXBlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlTW9kYWxFc2NhcGUpO1xyXG59XHJcblxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocG9wdXApKTtcclxufSk7XHJcblxyXG5hbGxNb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZXhpdE1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBDYXJkIGZ1bmN0aW9uc1xyXG5cclxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcclxuICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2V0QnV0dG9uVGV4dChldnQuc3VibWl0dGVyLCB0cnVlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gIGFwaVxyXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICAgIGRpc2FibGVCdXR0b24oY2FyZFN1Ym1pdEJ1dHRvbik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGNhcmQ6XCIsIGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIGZhbHNlLCBcIkRlbGV0aW5nLi4uXCIsIFwiRGVsZXRlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGNhcmROYW1lRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3BhcmFncmFwaFwiKTtcclxuICBjb25zdCBjYXJkSW1nRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGhlYXJ0TGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnRuLWhlYXJ0XCIpO1xyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uLWRlbGV0ZVwiKTtcclxuXHJcbiAgY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1nRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWdFbC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGhlYXJ0TGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fYnRuLWhlYXJ0X2ZpbGxlZFwiKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGVhcnRMaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19idG4taGVhcnRfZmlsbGVkXCIpO1xyXG4gIH1cclxuXHJcbiAgaGVhcnRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICB0b2dnbGVMaWtlKGV2dCwgZGF0YSk7XHJcbiAgfSk7XHJcbiAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpO1xyXG4gIH0pO1xyXG4gIGNhcmRJbWdFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWdFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWdFbC5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoe1xyXG4gICAgICBuYW1lOiBjYXJkQ2FwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgICBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNvbnN0IG5ld0NhcmQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQobmV3Q2FyZCk7XHJcbiAgICAgIGNhcmRGb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGV2dC5zdWJtaXR0ZXIpO1xyXG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBuZXcgY2FyZDpcIiwgZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoZXZ0LnN1Ym1pdHRlciwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZUxpa2UoZXZ0LCBkYXRhKSB7XHJcbiAgY29uc3QgaGVhcnRJY29uID0gZXZ0LnRhcmdldDtcclxuICBhcGlcclxuICAgIC5jaGFuZ2VMaWtlU3RhdHVzKGRhdGEuX2lkLCBkYXRhLmlzTGlrZWQpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGhlYXJ0SWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnRuLWhlYXJ0X2ZpbGxlZFwiKTtcclxuICAgICAgZGF0YS5pc0xpa2VkID0gIWRhdGEuaXNMaWtlZDtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiTGlrZSBzdGF0dXMgbm90IGNoYW5nZWQ6XCIsIGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuXHJcbmNhcmRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUFkZENhcmRTdWJtaXQpO1xyXG5kZWxldGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcbmRlbGV0ZUNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIFByb2ZpbGUgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHByb2ZpbGVOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGFib3V0OiBwcm9maWxlSm9iSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVKb2IudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGV2dC5zdWJtaXR0ZXIpO1xyXG4gICAgICBjbG9zZU1vZGFsKHByb2ZpbGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHVzZXIgaW5mbzpcIiwgZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHNldEJ1dHRvblRleHQoZXZ0LnN1Ym1pdHRlciwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIHByb2ZpbGVKb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgcHJvZmlsZUZvcm1FbGVtZW50LFxyXG4gICAgW3Byb2ZpbGVOYW1lSW5wdXQsIHByb2ZpbGVKb2JJbnB1dF0sXHJcbiAgICBzZXR0aW5nc1xyXG4gICk7XHJcbiAgb3Blbk1vZGFsKHByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5cclxuLy8gQXZhdGFyIGZ1bmN0aW9uc1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBzZXRCdXR0b25UZXh0KGV2dC5zdWJtaXR0ZXIsIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgYXZhdGFyLnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICBhdmF0YXIuYWx0ID0gXCJBdmF0YXIgb2YgXCIgKyBkYXRhLm5hbWU7XHJcbiAgICAgIGNvbnNvbGUubG9nKGV2dC5zdWJtaXR0ZXIpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGV2dC5zdWJtaXR0ZXIpO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgICAgYXZhdGFyRm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChldnQuc3VibWl0dGVyLCBmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYXZhdGFyTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gIHJlc2V0VmFsaWRhdGlvbihhdmF0YXJGb3JtRWxlbWVudCwgW2F2YXRhcklucHV0XSwgc2V0dGluZ3MpO1xyXG59KTtcclxuXHJcbmF2YXRhckZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICAgIHRoaXMuX2NoZWNrUmVzcG9uc2UgPSB0aGlzLl9jaGVja1Jlc3BvbnNlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdEF2YXRhckluZm8oYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGNoYW5nZUxpa2VTdGF0dXMoY2FyZElkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiZGlzYWJsZUJ1dHRvbiIsImJ1dHRvbkVsIiwiZGlzYWJsZWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiaGFzSW52YWxpZElucHV0IiwiYWRkIiwiZW5hYmxlQnV0dG9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJzZXRFdmVudExpc3RlbmVycyIsIkFycmF5IiwiZnJvbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsInNldEJ1dHRvblRleHQiLCJidXR0b24iLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsIm9yaWdpbmFsVGV4dCIsInByb2ZpbGVMb2dvIiwiYXZhdGFyIiwiYXZhdGFyQnRuIiwiZWRpdEJ0biIsInBvc3RCdG4iLCJwcm9maWxlQ2xvc2UiLCJhZGRQb3N0Q2xvc2UiLCJhdmF0YXJDbG9zZSIsInNyYyIsImxvZ29JbWFnZSIsInByb2ZpbGVBdmF0YXIiLCJ3aGl0ZVBlbmNpbCIsInByb2ZpbGVFZGl0QnRuIiwiYWRkUG9zdEJ0biIsImNsb3NlQnRuIiwiY2xvc2VCdXR0b25zIiwiYWxsTW9kYWxzIiwicHJvZmlsZU1vZGFsIiwicHJvZmlsZUZvcm1FbGVtZW50IiwiZm9ybXMiLCJlZGl0UHJvZmlsZSIsInByb2ZpbGVOYW1lSW5wdXQiLCJwcm9maWxlSm9iSW5wdXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUpvYiIsImNhcmRNb2RhbCIsImNhcmRTdWJtaXRCdXR0b24iLCJjYXJkRm9ybUVsZW1lbnQiLCJhZGRQb3N0IiwiY2FyZExpbmtJbnB1dCIsImVsZW1lbnRzIiwibGluayIsImNhcmRDYXB0aW9uSW5wdXQiLCJjYXB0aW9uIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwiYWRkQ2FyZEJ1dHRvbiIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbENhcHRpb25FbCIsInByZXZpZXdNb2RhbEltZ0VsIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJNb2RhbEJ0biIsImF2YXRhckZvcm1FbGVtZW50IiwiY2hhbmdlQXZhdGFyIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm1FbGVtZW50IiwiZGVsZXRlQ2FuY2VsQnV0dG9uIiwiYXBpIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwidGhpcyIsIl9iYXNlVXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwiYmluZCIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRBcHBJbmZvIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJlZGl0VXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImVkaXRBdmF0YXJJbmZvIiwiYWRkTmV3Q2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJjaGFuZ2VMaWtlU3RhdHVzIiwiaXNMaWtlZCIsImF1dGhvcml6YXRpb24iLCJleGl0TW9kYWwiLCJldnQiLCJjbG9zZU1vZGFsIiwidGFyZ2V0IiwiaGFuZGxlTW9kYWxFc2NhcGUiLCJrZXkiLCJvcGVuTW9kYWwiLCJtb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1nRWwiLCJoZWFydExpa2VCdXR0b24iLCJkZWxldGVCdXR0b24iLCJhbHQiLCJoZWFydEljb24iLCJfaWQiLCJ0b2dnbGUiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInRvZ2dsZUxpa2UiLCJwcmV2ZW50RGVmYXVsdCIsImhhbmRsZURlbGV0ZUNhcmQiLCJjYXJkcyIsInVzZXJJbmZvIiwiY2FyZCIsInByZXBlbmQiLCJwb3B1cCIsImNsb3Nlc3QiLCJzdWJtaXR0ZXIiLCJ2YWx1ZSIsIm5ld0NhcmQiLCJyZXNldCIsImZpbmFsbHkiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9