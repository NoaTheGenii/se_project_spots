!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-btn",inactiveButtonClass:"modal__save-btn_disabled",inputErrorClass:"modal__input_invalid",errorClass:"modal__error"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},o=e=>{e.disabled=!0},n=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?(t.classList.add(r.inactiveButtonClass),o(t)):(t.classList.remove(r.inactiveButtonClass),(e=>{e.disabled=!1})(t))},a=e=>{document.querySelectorAll(e.formSelector).forEach(t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach(c=>{c.addEventListener("input",function(){n(o,a,t),((e,t,o)=>{t.validity.valid?r(e,t,o):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,c,t)})})})(t,e)})},c=(e,t,o)=>{t.forEach(t=>{r(e,t,o)})};a(t);var s=e+"8650253b58b46f0f1c06.svg",d=e+"ebe4a21ad964c3f377bb.png",l=e+"d423b294ea8188f53fb6.svg",i=e+"d0d66fed7ed9e2c3e979.svg",u=e+"a326e1ad56a2cd944a28.svg",m=e+"d73f076c46eb5467f5fc.svg";const f=document.querySelector("#header-logo"),v=document.querySelector("#bessie-colman-avatar"),_=document.querySelector("#profile-avatar-btn"),h=document.querySelector("#profile-edit-btn"),p=document.querySelector("#profile-add-btn"),b=document.querySelector("#edit-profile-close-btn"),y=document.querySelector("#add-post-close-btn"),S=document.querySelector("#avatar-close-btn");f.src=s,v.src=d,_.src=m,h.src=l,p.src=i,b.src=u,y.src=u,S.src=u;const q=document.querySelectorAll(".modal__close-btn"),E=document.querySelectorAll(".modal"),g=document.querySelector("#edit-profile-modal"),C=document.forms.editProfile,L=g.querySelector("#profile-name-input"),k=g.querySelector("#profile-job-input"),A=document.querySelector(".profile__edit-btn"),$=document.querySelector(".profile__name"),j=document.querySelector(".profile__text"),U=document.querySelector("#add-post-modal"),I=document.querySelector(".modal__save-btn"),P=document.forms.addPost,x=P.elements.link,B=P.elements.caption,D=document.querySelector("#card-template"),w=document.querySelector(".cards__list"),T=document.querySelector(".profile__add-img"),N=(document.querySelector(".card__button-delete"),document.querySelector("#preview-modal")),H=N.querySelector(".modal__caption"),J=N.querySelector(".modal__img"),O=document.querySelector("#avatar-modal"),z=document.querySelector(".profile__avatar-btn"),M=document.forms.changeAvatar,F=M.elements.avatar,G=document.querySelector("#delete-modal"),K=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}getUserInfo(){return fetch(`${this._baseUrl}/users`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"a90bdb36-e55c-4a6c-9bf2-6ab2312d2f70","Content-Type":"application/json"}});function Q(e){e.target.classList.toggle("card__btn-heart_filled")}function R(e){const t=D.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__paragraph"),o=t.querySelector(".card__image"),n=t.querySelector(".card__btn-heart"),a=t.querySelector(".card__button-delete");return r.textContent=e.name,o.src=e.link,o.alt=e.name,n.addEventListener("click",Q),a.addEventListener("click",e=>{e.preventDefault(),X(G),K.deleteCard(undefined).then(()=>{undefined.remove()}).catch(console.error)}),o.addEventListener("click",()=>{X(N),J.src=e.link,J.alt=e.name,H.textContent=e.name}),t}function V(e){Y(e.target)}function W(e){"Escape"!==e.key&&27!==e.key||Y(document.querySelector(".modal_opened"))}function X(e){e.classList.add("modal_opened"),document.addEventListener("keydown",W)}function Y(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",W)}K.getAppInfo().then(([e])=>{e.forEach(e=>{const t=R(e);return w.prepend(t)})}).catch(console.error),q.forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>Y(t))}),E.forEach(e=>{e.addEventListener("click",V)}),A.addEventListener("click",()=>{L.value=$.textContent,k.value=j.textContent,c(C,[L,k],t),X(g)}),C.addEventListener("submit",function(e){e.preventDefault(),K.editUserInfo({name:L.value,about:k.value}).then(e=>{$.textContent=e.name,j.textContent=e.about}).catch(console.error),Y(g)}),T.addEventListener("click",()=>{X(U)}),P.addEventListener("submit",function(e){e.preventDefault();const t=R({name:B.value,link:x.value});w.prepend(t),P.reset(),o(I),Y(U)}),z.addEventListener("click",()=>{X(O),c(M,[F],t)}),M.addEventListener("submit",function(e){e.preventDefault(),K.editAvatarInfo(F.value).then(e=>{v.src=e.avatar,v.alt="Avatar of "+e.name}).catch(console.error),Y(O),M.reset()}),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gICAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmUtYnRuXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ0bl9kaXNhYmxlZFwiLFxyXG4gICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF9pbnZhbGlkXCIsXHJcbiAgICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBlcnJvck1zZ0VsID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gICAgZXJyb3JNc2dFbC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbCkgPT4ge1xyXG4gICAgYnV0dG9uRWwuZGlzYWJsZWQgPSB0cnVlO1xyXG59O1xyXG5cclxuY29uc3QgZW5hYmxlQnV0dG9uID0gKGJ1dHRvbkVsKSA9PiB7XHJcbiAgICBidXR0b25FbC5kaXNhYmxlZCA9IGZhbHNlO1xyXG59O1xyXG5cclxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XHJcbiAgICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgICAgICBidXR0b25FbC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYnV0dG9uRWwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgICAgZW5hYmxlQnV0dG9uKGJ1dHRvbkVsKTtcclxuICAgIH1cclxufTtcclxuXHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICBjb25zdCBidXR0b25FbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpO1xyXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gICAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gICAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICAgICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0QXBwSW5mbygpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRBdmF0YXJJbmZvKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iLCJpbXBvcnQge1xyXG4gIHNldHRpbmdzLFxyXG4gIGRpc2FibGVCdXR0b24sXHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICByZXNldFZhbGlkYXRpb24sXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IGxvZ29JbWFnZSBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XHJcbmltcG9ydCBwcm9maWxlQXZhdGFyIGZyb20gXCIuLi9pbWFnZXMvYmVzc2llLWNvbG1hbi5wbmdcIjtcclxuaW1wb3J0IHByb2ZpbGVFZGl0QnRuIGZyb20gXCIuLi9pbWFnZXMvZWRpdC1idXR0b24tcGVuY2lsLnN2Z1wiO1xyXG5pbXBvcnQgYWRkUG9zdEJ0biBmcm9tIFwiLi4vaW1hZ2VzL3Bvc3QtYnV0dG9uLnN2Z1wiO1xyXG5pbXBvcnQgY2xvc2VCdG4gZnJvbSBcIi4uL2ltYWdlcy9jbG9zZS1idXR0b24uc3ZnXCI7XHJcbmltcG9ydCB3aGl0ZVBlbmNpbCBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC13aGl0ZS5zdmdcIjtcclxuXHJcbmNvbnN0IHByb2ZpbGVMb2dvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNoZWFkZXItbG9nb1wiKTtcclxuY29uc3QgYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNiZXNzaWUtY29sbWFuLWF2YXRhclwiKTtcclxuY29uc3QgYXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1idG5cIik7XHJcbmNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idG5cIik7XHJcbmNvbnN0IHBvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZUNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBhZGRQb3N0Q2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3N0LWNsb3NlLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyQ2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1jbG9zZS1idG5cIik7XHJcblxyXG5wcm9maWxlTG9nby5zcmMgPSBsb2dvSW1hZ2U7XHJcbmF2YXRhci5zcmMgPSBwcm9maWxlQXZhdGFyO1xyXG5hdmF0YXJCdG4uc3JjID0gd2hpdGVQZW5jaWw7XHJcbmVkaXRCdG4uc3JjID0gcHJvZmlsZUVkaXRCdG47XHJcbnBvc3RCdG4uc3JjID0gYWRkUG9zdEJ0bjtcclxucHJvZmlsZUNsb3NlLnNyYyA9IGNsb3NlQnRuO1xyXG5hZGRQb3N0Q2xvc2Uuc3JjID0gY2xvc2VCdG47XHJcbmF2YXRhckNsb3NlLnNyYyA9IGNsb3NlQnRuO1xyXG5cclxuY29uc3QgY2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBhbGxNb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLmVkaXRQcm9maWxlO1xyXG5jb25zdCBwcm9maWxlTW9kYWxOYW1lSW5wdXQgPSBwcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVNb2RhbEpvYklucHV0ID0gcHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1qb2ItaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RleHRcIik7XHJcblxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1wb3N0LW1vZGFsXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZS1idG5cIik7XHJcbmNvbnN0IGNhcmRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zLmFkZFBvc3Q7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkRm9ybUVsZW1lbnQuZWxlbWVudHMubGluaztcclxuY29uc3QgY2FyZENhcHRpb25JbnB1dCA9IGNhcmRGb3JtRWxlbWVudC5lbGVtZW50cy5jYXB0aW9uO1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1pbWdcIik7XHJcbmNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2J1dHRvbi1kZWxldGVcIik7XHJcblxyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbENhcHRpb25FbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWdFbCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWdcIik7XHJcblxyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuY29uc3QgYXZhdGFyRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtcy5jaGFuZ2VBdmF0YXI7XHJcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyRm9ybUVsZW1lbnQuZWxlbWVudHMuYXZhdGFyO1xyXG5cclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImE5MGJkYjM2LWU1NWMtNGE2Yy05YmYyLTZhYjIzMTJkMmY3MFwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkc10pID0+IHtcclxuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkKTtcclxuICAgICAgcmV0dXJuIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG5cclxuZnVuY3Rpb24gdG9nZ2xlTGlrZShldnQpIHtcclxuICBjb25zdCBoZWFydEljb24gPSBldnQudGFyZ2V0O1xyXG4gIGhlYXJ0SWNvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnRuLWhlYXJ0X2ZpbGxlZFwiKTtcclxufVxyXG5cclxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhKSB7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVTdWJtaXQoZXZ0KSB7fVxyXG5cclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fcGFyYWdyYXBoXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWdFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgaGVhcnRMaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idG4taGVhcnRcIik7XHJcbiAgY29uc3QgZGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b24tZGVsZXRlXCIpO1xyXG5cclxuICBjYXJkTmFtZUVsLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gIGNhcmRJbWdFbC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZEltZ0VsLmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgaGVhcnRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0b2dnbGVMaWtlKTtcclxuICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSk7XHJcbiAgfSk7XHJcbiAgY2FyZEltZ0VsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICAgIHByZXZpZXdNb2RhbEltZ0VsLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEltZ0VsLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdNb2RhbENhcHRpb25FbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBleGl0TW9kYWwoZXZ0KSB7XHJcbiAgY2xvc2VNb2RhbChldnQudGFyZ2V0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTW9kYWxFc2NhcGUoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIgfHwgZXZ0LmtleSA9PT0gMjcpIHtcclxuICAgIGNvbnN0IG9wZW5lZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBjbG9zZU1vZGFsKG9wZW5lZE1vZGFsKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlTW9kYWxFc2NhcGUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVNb2RhbEVzY2FwZSk7XHJcbn1cclxuXHJcbmNsb3NlQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcclxuICBjb25zdCBwb3B1cCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xyXG4gIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChwb3B1cCkpO1xyXG59KTtcclxuXHJcbmFsbE1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xyXG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBleGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIFByb2ZpbGUgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiBwcm9maWxlTW9kYWxOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGFib3V0OiBwcm9maWxlTW9kYWxKb2JJbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgcHJvZmlsZUpvYi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG4gIGNsb3NlTW9kYWwocHJvZmlsZU1vZGFsKTtcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlTW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBwcm9maWxlTW9kYWxKb2JJbnB1dC52YWx1ZSA9IHByb2ZpbGVKb2IudGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgcHJvZmlsZUZvcm1FbGVtZW50LFxyXG4gICAgW3Byb2ZpbGVNb2RhbE5hbWVJbnB1dCwgcHJvZmlsZU1vZGFsSm9iSW5wdXRdLFxyXG4gICAgc2V0dGluZ3NcclxuICApO1xyXG4gIG9wZW5Nb2RhbChwcm9maWxlTW9kYWwpO1xyXG59KTtcclxuXHJcbnByb2ZpbGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuXHJcbi8vIENhcmQgZnVuY3Rpb25zXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IG5ld0NhcmQgPSB7XHJcbiAgICBuYW1lOiBjYXJkQ2FwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSxcclxuICB9O1xyXG4gIGNvbnN0IGNhcmRFbCA9IGdldENhcmRFbGVtZW50KG5ld0NhcmQpO1xyXG4gIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbCk7XHJcbiAgY2FyZEZvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgZGlzYWJsZUJ1dHRvbihjYXJkU3VibWl0QnV0dG9uKTtcclxuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbn1cclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYXJkRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuXHJcbi8vIEF2YXRhciBmdW5jdGlvbnNcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhckluZm8oYXZhdGFySW5wdXQudmFsdWUpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBhdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICAgIGF2YXRhci5hbHQgPSBcIkF2YXRhciBvZiBcIiArIGRhdGEubmFtZTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XHJcbiAgYXZhdGFyRm9ybUVsZW1lbnQucmVzZXQoKTtcclxufVxyXG5cclxuYXZhdGFyTW9kYWxCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gIHJlc2V0VmFsaWRhdGlvbihhdmF0YXJGb3JtRWxlbWVudCwgW2F2YXRhcklucHV0XSwgc2V0dGluZ3MpO1xyXG59KTtcclxuXHJcbmF2YXRhckZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCk7XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJkaXNhYmxlQnV0dG9uIiwiYnV0dG9uRWwiLCJkaXNhYmxlZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJhZGQiLCJlbmFibGVCdXR0b24iLCJlbmFibGVWYWxpZGF0aW9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInJlc2V0VmFsaWRhdGlvbiIsImlucHV0IiwicHJvZmlsZUxvZ28iLCJhdmF0YXIiLCJhdmF0YXJCdG4iLCJlZGl0QnRuIiwicG9zdEJ0biIsInByb2ZpbGVDbG9zZSIsImFkZFBvc3RDbG9zZSIsImF2YXRhckNsb3NlIiwic3JjIiwibG9nb0ltYWdlIiwicHJvZmlsZUF2YXRhciIsIndoaXRlUGVuY2lsIiwicHJvZmlsZUVkaXRCdG4iLCJhZGRQb3N0QnRuIiwiY2xvc2VCdG4iLCJjbG9zZUJ1dHRvbnMiLCJhbGxNb2RhbHMiLCJwcm9maWxlTW9kYWwiLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJmb3JtcyIsImVkaXRQcm9maWxlIiwicHJvZmlsZU1vZGFsTmFtZUlucHV0IiwicHJvZmlsZU1vZGFsSm9iSW5wdXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZUpvYiIsImNhcmRNb2RhbCIsImNhcmRTdWJtaXRCdXR0b24iLCJjYXJkRm9ybUVsZW1lbnQiLCJhZGRQb3N0IiwiY2FyZExpbmtJbnB1dCIsImVsZW1lbnRzIiwibGluayIsImNhcmRDYXB0aW9uSW5wdXQiLCJjYXB0aW9uIiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0IiwiYWRkQ2FyZEJ1dHRvbiIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbENhcHRpb25FbCIsInByZXZpZXdNb2RhbEltZ0VsIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJNb2RhbEJ0biIsImF2YXRhckZvcm1FbGVtZW50IiwiY2hhbmdlQXZhdGFyIiwiYXZhdGFySW5wdXQiLCJkZWxldGVNb2RhbCIsImFwaSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInRoaXMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFySW5mbyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhdXRob3JpemF0aW9uIiwidG9nZ2xlTGlrZSIsImV2dCIsInRhcmdldCIsInRvZ2dsZSIsImdldENhcmRFbGVtZW50IiwiZGF0YSIsImNhcmRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1nRWwiLCJoZWFydExpa2VCdXR0b24iLCJkZWxldGVCdXR0b24iLCJhbHQiLCJwcmV2ZW50RGVmYXVsdCIsIm9wZW5Nb2RhbCIsInNlbGVjdGVkQ2FyZElkIiwic2VsZWN0ZWRDYXJkIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJleGl0TW9kYWwiLCJjbG9zZU1vZGFsIiwiaGFuZGxlTW9kYWxFc2NhcGUiLCJrZXkiLCJtb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjYXJkcyIsImNhcmQiLCJwcmVwZW5kIiwiYnV0dG9uIiwicG9wdXAiLCJjbG9zZXN0IiwidmFsdWUiLCJjYXJkRWwiLCJyZXNldCJdLCJzb3VyY2VSb290IjoiIn0=